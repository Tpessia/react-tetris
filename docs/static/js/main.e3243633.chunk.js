(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{34:function(t,e,n){t.exports=n(49)},39:function(t,e,n){},40:function(t,e,n){},45:function(t,e,n){},48:function(t,e,n){t.exports=n.p+"static/media/tetris.37fb910f.mp3"},49:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),r=n(24),o=n.n(r),h=(n(39),n(40),n(21)),c=n(1),s=n(9),l=n(12),u=n(25),d=n(26),f=n.n(d),v=n(51),p=n(13);function b(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}var O=n(4),g=n(6),j=n(5),w=n(7),y=n(27),x={container:{width:-1,height:-1},canvas:{width:-1,height:-1,backgroundColor:"transparent",patternBG:"#44444433",patternInnerBG:"#55555533",patternStroke:"#11111133",patternWidth:1,gridWidth:15,gridHeight:30},pixel:{offset:-1,widthT:-1,heightT:-1,width:10,height:10,backgroundColor:"#888",strokeColor:"#555",strokeWidth:3}};x.pixel.offset=x.pixel.strokeWidth/2,x.pixel.widthT=x.pixel.width+x.pixel.strokeWidth,x.pixel.heightT=x.pixel.height+x.pixel.strokeWidth,x.canvas.width=x.pixel.widthT*x.canvas.gridWidth,x.canvas.height=x.pixel.heightT*x.canvas.gridHeight,x.container.width=x.canvas.width,x.container.height=x.canvas.height;var k,S=x;!function(t){t[t.Up=0]="Up",t[t.Right=1]="Right",t[t.Bottom=2]="Bottom",t[t.Left=3]="Left"}(k||(k={}));var T=Object.values(k).filter((function(t){return"number"===typeof t})),m=function(){function t(e){Object(O.a)(this,t),this.rotationShapes=void 0,this.nested=void 0,this.pixels=[],this.rotation=0,this.offset=S.pixel.offset,this.strokeWidth=S.pixel.strokeWidth,this.strokeColor=S.pixel.strokeColor,this.width=S.pixel.width,this.height=S.pixel.height,this.widthT=S.pixel.widthT,this.heightT=S.pixel.heightT,this.offsetX=this.width+this.strokeWidth,this.offsetY=this.height+this.strokeWidth,this.nested=e.nested()}return Object(y.a)(t,[{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];for(var i in t)for(var a in t[i]){var r=t[i][a];if(0!==r){var o=e?this.nested.rect(this.width,this.height):this.pixels[r-1];o=o.x(+a*this.offsetX+this.offset).y(+i*this.offsetY+this.offset),n.push(o)}}return n}},{key:"build",value:function(){return this.rotation=T[b(0,T.length-1)],this.pixels=this.render(this.rotationShapes[this.rotation],!0),this.nested.fill(S.pixel.backgroundColor).stroke({width:this.strokeWidth,color:this.strokeColor}),this}},{key:"rotate",value:function(){this.rotation=this.rotation===k.Left?k.Up:this.rotation+1,this.pixels=this.render(this.rotationShapes[this.rotation])}},{key:"widthGap",get:function(){var t=this.rotationShapes[this.rotation],e=0;for(var n in t[0]){var i=!1;for(var a in t)0!==t[a][n]&&(i=!0);i||e++}return e}},{key:"widthStartGap",get:function(){var t=this.rotationShapes[this.rotation],e=0;for(var n in t[0]){var i=!1;for(var a in t)0!==t[a][n]&&(i=!0);if(i)break;e++}return e}},{key:"heightGap",get:function(){var t=this.rotationShapes[this.rotation],e=0;for(var n in t){var i=!1;for(var a in t[0])0!==t[n][a]&&(i=!0);i||e++}return e}},{key:"heightStartGap",get:function(){var t=this.rotationShapes[this.rotation],e=0;for(var n in t){var i=!1;for(var a in t[0])0!==t[n][a]&&(i=!0);if(i)break;e++}return e}},{key:"realWidth",get:function(){return this.nested.bbox().width+this.widthGap*this.widthT}},{key:"realStartWidth",get:function(){return this.nested.bbox().width+this.widthStartGap*this.widthT}},{key:"realHeight",get:function(){return this.nested.bbox().height+this.heightGap*this.heightT}},{key:"realStartHeight",get:function(){return this.nested.bbox().height+this.heightStartGap*this.heightT}}]),t}(),E=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[0,4,0],[0,3,0],[1,2,0]]),Object(c.a)(n,k.Right,[[1,0,0],[2,3,4],[0,0,0]]),Object(c.a)(n,k.Bottom,[[0,2,1],[0,3,0],[0,4,0]]),Object(c.a)(n,k.Left,[[0,0,0],[4,3,2],[0,0,1]]),n),i}return Object(w.a)(e,t),e}(m),W=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[0,0,1],[0,3,2],[0,4,0]]),Object(c.a)(n,k.Right,[[0,0,0],[4,3,0],[0,2,1]]),Object(c.a)(n,k.Bottom,[[0,4,0],[2,3,0],[1,0,0]]),Object(c.a)(n,k.Left,[[1,2,0],[0,3,4],[0,0,0]]),n),i}return Object(w.a)(e,t),e}(m),G=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[0,0,1,0],[0,0,2,0],[0,0,3,0],[0,0,4,0]]),Object(c.a)(n,k.Right,[[0,0,0,0],[0,0,0,0],[1,2,3,4],[0,0,0,0]]),Object(c.a)(n,k.Bottom,[[0,0,1,0],[0,0,2,0],[0,0,3,0],[0,0,4,0]]),Object(c.a)(n,k.Left,[[0,0,0,0],[0,0,0,0],[1,2,3,4],[0,0,0,0]]),n),i}return Object(w.a)(e,t),e}(m),M=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[0,4,0],[0,3,0],[0,2,1]]),Object(c.a)(n,k.Right,[[0,0,0],[2,3,4],[1,0,0]]),Object(c.a)(n,k.Bottom,[[1,2,0],[0,3,0],[0,4,0]]),Object(c.a)(n,k.Left,[[0,0,1],[4,3,2],[0,0,0]]),n),i}return Object(w.a)(e,t),e}(m),B=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[1,0,0],[2,3,0],[0,4,0]]),Object(c.a)(n,k.Right,[[0,2,1],[4,3,0],[0,0,0]]),Object(c.a)(n,k.Bottom,[[0,4,0],[0,3,2],[0,0,1]]),Object(c.a)(n,k.Left,[[0,0,0],[0,3,4],[1,2,0]]),n),i}return Object(w.a)(e,t),e}(m),C=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[1,2],[3,4]]),Object(c.a)(n,k.Right,[[3,1],[4,2]]),Object(c.a)(n,k.Bottom,[[4,3],[2,1]]),Object(c.a)(n,k.Left,[[2,4],[1,3]]),n),i}return Object(w.a)(e,t),e}(m),R=function(t){function e(){var t,n,i;Object(O.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(i=Object(g.a)(this,(t=Object(j.a)(e)).call.apply(t,[this].concat(r)))).rotationShapes=(n={},Object(c.a)(n,k.Up,[[0,1,0],[2,3,4],[0,0,0]]),Object(c.a)(n,k.Right,[[0,2,0],[0,3,1],[0,4,0]]),Object(c.a)(n,k.Bottom,[[0,0,0],[4,3,2],[0,1,0]]),Object(c.a)(n,k.Left,[[0,4,0],[1,3,0],[0,2,0]]),n),i}return Object(w.a)(e,t),e}(m),L=(n(45),n(20)),U=n(10),A=n(11);function H(){var t=Object(U.a)(["\n    display: flex;\n    border: 3px solid #000;\n"]);return H=function(){return t},t}function V(){var t=Object(U.a)(["\n    \n"]);return V=function(){return t},t}function _(){var t=Object(U.a)(["\n    margin-left: 10px;\n"]);return _=function(){return t},t}function I(){var t=Object(U.a)(["\n    display: flex;\n"]);return I=function(){return t},t}var P=A.a.div(I()),D=A.a.div(_()),N=A.a.div(V()),Y=A.a.div(H()),F=n(48),J=function(){var t=Object(i.useState)(null),e=Object(l.a)(t,2),n=e[0],r=e[1],o=Object(i.useState)({score:0,paused:!1,ended:!1}),d=Object(l.a)(o,2),O=d[0],g=d[1],j=Object(i.useRef)([]),w=Object(i.useState)(null),y=Object(l.a)(w,2),x=y[0],k=y[1],T=Object(i.useRef)([]),m=Object(i.useState)({available:!0,count:0}),U=Object(l.a)(m,2),A=U[0],H=U[1],V=null,_=function(){var t,e;O.ended||(O.paused?null===(t=V)||void 0===t||t.play():null===(e=V)||void 0===e||e.pause(),g(Object(s.a)({},O,{paused:!O.paused})))},I=function(t){var e=t.nested.x()/t.widthT,n=t.nested.y()/t.heightT;return t.nested.children().map((function(i){var a=i,r=(a.x()-t.offset)/t.widthT,o=(a.y()-t.offset)/t.heightT;return{x:r+e,y:o+n,pixel:a}}))},J=Object(i.useCallback)((function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=!1,r=I(e),o=!0,h=!1,c=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u,d,f,v=s.value;("down"===n&&(null===(u=j.current[v.y+1])||void 0===u?void 0:u[v.x])||"left"===n&&(null===(d=j.current[v.y])||void 0===d?void 0:d[v.x-1])||"right"===n&&(null===(f=j.current[v.y])||void 0===f?void 0:f[v.x+1]))&&(a=!0)}}catch(b){h=!0,c=b}finally{try{o||null==l.return||l.return()}finally{if(h)throw c}}var p=K(t,e)-i;return a||p<=0}),[j]),K=function(t,e){return t.height()-(e.nested.y()+e.strokeWidth+e.realStartHeight)},X=Object(i.useCallback)((function(t){if(t.nested.x()<-t.widthStartGap*t.widthT)t.nested.x(t.widthStartGap*t.widthT);else if(t.nested.x()+t.realStartWidth>S.canvas.width)t.nested.x(S.canvas.width-t.realStartWidth-t.strokeWidth);else{var e=t.nested.y();t.nested.y(t.nested.y()-t.heightT),x&&!J(x,t,"down")&&t.nested.y(e)}}),[x,J]);Object(i.useEffect)((function(){!function(){if(n&&!x){var t=Object(u.a)().size(S.container.width,S.container.height),e=t.rect(S.canvas.width,S.canvas.height).fill(S.canvas.backgroundColor),i=t.pattern(S.pixel.widthT,S.pixel.heightT,(function(t){t.rect(S.pixel.widthT,S.pixel.heightT).fill(S.canvas.patternBG),t.rect(S.pixel.width,S.pixel.height).x(S.pixel.offset).y(S.pixel.offset).fill(S.canvas.patternInnerBG).stroke({color:S.canvas.patternStroke,width:S.canvas.patternWidth})}));e.fill(i),t.addTo(n),k(t)}}()}),[n,x]),Object(i.useEffect)((function(){if(!O.paused&&!O.ended&&x&&A.available){var t;H(Object(s.a)({},A,{available:!1}));var e=null,n=null,i=T.current.find((function(t){return t.active}));if(i){var a=I(i.shape);if(J(x,i.shape,"down")){var r;if(a.some((function(t){return t.y<0})))return null===(r=V)||void 0===r||r.pause(),void g(Object(s.a)({},O,{paused:!1,ended:!0}));n=Object(v.a)(j.current);var o=!0,l=!1,u=void 0;try{for(var d,p=a[Symbol.iterator]();!(o=(d=p.next()).done);o=!0){var w=d.value;n[w.y]||(n[w.y]=[]),n[w.y][w.x]=w.pixel}}catch(Q){l=!0,u=Q}finally{try{o||null==p.return||p.return()}finally{if(l)throw u}}var y=T.current.indexOf(i);e=f()(T.current,Object(c.a)({},y,{active:{$set:!1}})),i=void 0}}if(!i)i={active:!0,shape:function(t){var e=[E,W,G,M,B,C,R],n=function(t,e){return new e(t).build()}(t,e[b(0,e.length-1)]),i=b(-n.widthStartGap*n.widthT,S.canvas.width-n.realStartWidth-n.strokeWidth),a=i-i%n.widthT,r=-Math.floor(n.rotationShapes[n.rotation].length-n.heightStartGap)*n.heightT-n.heightStartGap*n.heightT;return n.nested.x(a).y(r),n}(x)},e=[].concat(e?Object(h.a)(e):Object(h.a)(T.current),[i]);i.shape.nested.y(i.shape.nested.y()+S.pixel.heightT),X(i.shape);var k=null===(t=n)||void 0===t?void 0:t.reduce((function(t,e,n){return e&&e.filter((function(t){return!!t})).length===S.canvas.gridWidth&&t.push(n),t}),[]).reverse();if(k){var m=0,L=!0,U=!1,_=void 0;try{for(var P,D=k[Symbol.iterator]();!(L=(P=D.next()).done);L=!0){var N=P.value;N+=m;for(var Y=0;Y<S.canvas.gridWidth;Y++){var F,K;(null===(F=n)||void 0===F?void 0:null===(K=F[N])||void 0===K?void 0:K[Y])&&(n[N][Y].remove(),n[N][Y]=void 0)}for(var $=N-1;$>=0;$--){var z;(null===(z=n)||void 0===z?void 0:z[$])&&(n[$].forEach((function(t){t&&t.y(t.y()+S.pixel.heightT)})),n[$+1]=n[$],n[$]=void 0)}m++}}catch(Q){U=!0,_=Q}finally{try{L||null==D.return||D.return()}finally{if(U)throw _}}k.length>0&&g(Object(s.a)({},O,{score:O.score+100*Math.round(Math.pow(k.length,1.75))}))}e&&(T.current=e),n&&(j.current=n);var q=1e3-O.score/125e3;q=q<200?200:q,setTimeout((function(){return H({available:!0,count:A.count+1})}),q)}}),[A,O,x,X,J,V]);var $=function(t){var e=T.current.find((function(t){return t.active}));!e||O.paused||O.ended||t(e.shape)},z={MOVE_UP:function(t){$((function(t){t.rotate(),X(t)}))},MOVE_DOWN:function(t){$((function(t){var e=t.nested.y(),n=t.heightT;x&&!J(x,t,"down")&&t.nested.y(e+n),X(t)}))},MOVE_LEFT:function(t){$((function(t){var e=t.nested.x()-t.widthT;e>=-t.widthStartGap*t.widthT&&x&&!J(x,t,"left")&&t.nested.x(e),X(t)}))},MOVE_RIGHT:function(t){$((function(t){var e=t.nested.x()+t.widthT;e+t.realStartWidth<=S.canvas.width&&x&&!J(x,t,"right")&&t.nested.x(e),X(t)}))},SPACE:function(t){return _()}};return a.a.createElement(p.GlobalHotKeys,{allowChanges:!0,keyMap:{MOVE_UP:"up",MOVE_DOWN:"down",MOVE_LEFT:"left",MOVE_RIGHT:"right",SPACE:"space"},handlers:z},a.a.createElement("audio",{ref:function(t){return V=t},src:F,autoPlay:!0,loop:!0}),a.a.createElement(P,null,a.a.createElement(Y,{ref:function(t){return r(t)}}),a.a.createElement(D,null,a.a.createElement(N,null,O.score),a.a.createElement("button",{onClick:function(t){_()}},O.paused?a.a.createElement(L.b,null):a.a.createElement(L.a,null)),a.a.createElement("br",null),"Ended: ",O.ended?"YES":"NO")))},K=function(){return a.a.createElement(J,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(p.configure)({ignoreRepeatedEventsWhenKeyHeldDown:!1}),o.a.render(a.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[34,1,2]]]);
//# sourceMappingURL=main.e3243633.chunk.js.map